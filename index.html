<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<title>Genially Audio Player Editor</title>
<style>
:root{
  --accent:#00ff88;
  --bg:rgba(0,0,0,0);
  --text:#ffffff;
}
body{
  margin:0;font-family:Arial,Helvetica,sans-serif;background:#111;color:#fff;display:flex;height:100vh;
}
#editor{
  width:360px;padding:16px;background:#1b1b1b;box-sizing:border-box;overflow:auto;
}
#preview{
  flex:1;display:flex;align-items:center;justify-content:center;background:transparent;
}
label{display:block;margin-top:12px;font-size:13px;opacity:.8}
input,select,button,textarea{
  width:100%;margin-top:6px;padding:6px;border-radius:6px;border:none;box-sizing:border-box;
}
button{cursor:pointer;background:var(--accent);color:#000;font-weight:bold}
textarea{height:160px;background:#000;color:#0f0;font-size:12px}
/* PLAYER */
.player{
  width:260px;border-radius:24px;padding:16px;text-align:center;
  background:rgba(255,255,255,0.08);
  backdrop-filter:blur(12px);
}
.player img{
  width:160px;height:160px;border-radius:20px;object-fit:cover;margin:auto;display:block;
}
.title{margin-top:12px;font-weight:bold}
.artist{opacity:.7;font-size:13px}
.controls{display:flex;justify-content:center;align-items:center;gap:14px;margin-top:12px}
.controls button{
  width:42px;height:42px;border-radius:50%;border:none;background:var(--accent);
}
.range{width:100%}
.time{display:flex;justify-content:space-between;font-size:12px;opacity:.6}
.playlist{display:none;text-align:left;margin-top:10px;font-size:13px}
.playlist div{padding:4px;cursor:pointer}
.playlist div:hover{background:rgba(255,255,255,.1)}
</style>
</head>
<body>
<div id="editor">
  <h3>Редактор плеера</h3>
  <label>Цвет акцента</label>
  <input type="color" id="accent" value="#00ff88" />
  <label>Язык</label>
  <select id="lang"><option value="ru">Русский</option><option value="en">English</option></select>
  <label>Обложка (URL)</label>
  <input id="cover" value="https://picsum.photos/300" />
  <label>GitHub raw ссылки (по одной в строке)</label>
  <textarea id="tracks">https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3
https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3</textarea>
  <button onclick="generate()">Получить код</button>
  <textarea id="out"></textarea>
</div>
<div id="preview"></div>
<script>
let state={tracks:[],i:0,shuffle:false};
const preview=document.getElementById('preview');
function buildPlayer(){
  preview.innerHTML=`<div class="player" id="player">
  <img id="coverImg" src="${cover.value}" />
  <div class="title" id="title">Track</div>
  <div class="artist">Audio</div>
  <input class="range" id="seek" type="range" min="0" max="100" value="0" />
  <div class="time"><span id="cur">0:00</span><span id="dur">0:00</span></div>
  <div class="controls">
    <button id="prev">◀</button>
    <button id="play">▶</button>
    <button id="next">▶▶</button>
  </div>
  <button onclick="toggleList()">☰</button>
  <div class="playlist" id="list"></div>
  <audio id="audio"></audio>
  </div>`;
  initLogic();
}
function initLogic(){
  state.tracks=tracks.value.trim().split('\n');
  const audio=preview.querySelector('#audio');
  const play=preview.querySelector('#play');
  const seek=preview.querySelector('#seek');
  const list=preview.querySelector('#list');
  list.innerHTML='';
  state.tracks.forEach((t,i)=>{
    const d=document.createElement('div');d.textContent='Track '+(i+1);
    d.onclick=()=>load(i,true);list.appendChild(d);
  });
  function load(i,autoplay){
    state.i=i;audio.src=state.tracks[i];
    preview.querySelector('#title').textContent='Track '+(i+1);
    if(autoplay)audio.play();
  }
  load(0,false);
  play.onclick=()=>audio.paused?audio.play():audio.pause();
  audio.onplay=()=>play.textContent='❚❚';
  audio.onpause=()=>play.textContent='▶';
  audio.ontimeupdate=()=>{
    seek.value=audio.currentTime/audio.duration*100||0;
    cur.textContent=Math.floor(audio.currentTime/60)+':'+('0'+Math.floor(audio.currentTime%60)).slice(-2);
    dur.textContent=Math.floor(audio.duration/60)+':'+('0'+Math.floor(audio.duration%60)).slice(-2);
  }
  seek.oninput=()=>audio.currentTime=audio.duration*seek.value/100;
  prev.onclick=()=>load((state.i-1+state.tracks.length)%state.tracks.length,true);
  next.onclick=()=>load((state.i+1)%state.tracks.length,true);
}
function toggleList(){
  const l=preview.querySelector('#list');l.style.display=l.style.display==='block'?'none':'block';
}
function generate(){
  document.documentElement.style.setProperty('--accent',accent.value);
  buildPlayer();
  const code=`<div id="GENIALLY_AUDIO">${preview.innerHTML}
<style>${document.querySelector('style').innerHTML}</style>
<script>${initLogic.toString()}${toggleList.toString()}</script></div>`;
  out.value=code;
}
buildPlayer();
</script>
</body>
</html>
